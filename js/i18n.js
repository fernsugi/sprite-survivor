// Language System
const translations = {
    en: {
        spriteFontSize: "7px",
        costFontSize: "8px",
        descFontSize: "7px",
        title: "SPRITE SURVIVOR",
        subtitle: "Summon spirits, survive the horde",
        startGame: "START GAME",
        instructMove: "- Move",
        instructSummon: "- Summon sprites",
        instructSkill: "- Use skill (when available)",
        instructTip: "Collect orbs, summon sprites, survive!",
        hp: "HP",
        points: "POINTS",
        sprites: "SPRITES",
        skill: "SKILL",
        pressSpace: "[SPACE]",
        summonSprites: "SUMMON SPRITES",
        wave: "WAVE",
        nextWave: "Next wave",
        bossBattle: "BOSS BATTLE!",
        gameOver: "GAME OVER",
        finalScore: "Final Score",
        waveReached: "Wave Reached",
        restart: "RESTART",
        victory: "VICTORY!",
        victoryMsg: "You defeated the final boss!",
        playAgain: "PLAY AGAIN",
        language: "LANGUAGE",
        controlsHint: "WASD/Arrows move | 1-0 or ZXCVBNM,./ summon | SPACE skill | ESC pause",
        skillDash: "DASH",
        skillHeal: "FULL HEAL",
        skillNuke: "SCREEN BLAST",
        skillMagnet: "ORB MAGNET",
        time: "Time",
        archer: "Archer",
        knight: "Knight",
        mage: "Mage",
        cleric: "Cleric",
        ninja: "Ninja",
        wizard: "Wizard",
        berserker: "Berserker",
        frost: "Frost",
        vampire: "Vampire",
        bomber: "Bomber",
        descArcher: "Shoots arrows",
        descKnight: "Sword slash",
        descMage: "AOE magic",
        descCleric: "Heals you",
        descNinja: "Fast attacks",
        descWizard: "Lightning",
        descBerserker: "Spin attack",
        descFrost: "Slows enemies",
        descVampire: "Lifesteal hits",
        descBomber: "Explosive shots",
        boss1: "Demon Lord",
        boss2: "Shadow King",
        boss3: "Void Emperor",
        boss4: "Death Titan",
        paused: "PAUSED",
        pauseHint: "Press ESC to resume",
        resume: "RESUME",
        instructPause: "- Pause"
    },
    ja: {
        spriteFontSize: "9px",
        costFontSize: "7px",
        descFontSize: "9px",
        title: "スプライトサバイバー",
        subtitle: "精霊を召喚し、群れを生き延びろ",
        startGame: "ゲームスタート",
        instructMove: "- 移動",
        instructSummon: "- スプライト召喚",
        instructSkill: "- スキル発動（所持時）",
        instructTip: "オーブを集め、スプライトを召喚し、生き残れ！",
        hp: "HP",
        points: "ポイント",
        sprites: "スプライト",
        skill: "スキル",
        pressSpace: "[スペース]",
        summonSprites: "スプライト召喚",
        wave: "ウェーブ",
        nextWave: "次のウェーブ",
        bossBattle: "ボス戦！",
        gameOver: "ゲームオーバー",
        finalScore: "最終スコア",
        waveReached: "到達ウェーブ",
        restart: "リスタート",
        victory: "勝利！",
        victoryMsg: "最終ボスを倒した！",
        playAgain: "もう一度",
        language: "言語",
        controlsHint: "WASD/矢印 移動 | 1-0 or ZXCVBNM,./ 召喚 | スペース スキル | ESC 一時停止",
        skillDash: "ダッシュ",
        skillHeal: "全回復",
        skillNuke: "全画面攻撃",
        skillMagnet: "オーブ吸引",
        time: "タイム",
        archer: "アーチャー",
        knight: "ナイト",
        mage: "メイジ",
        cleric: "クレリック",
        ninja: "ニンジャ",
        wizard: "ウィザード",
        berserker: "バーサーカー",
        frost: "フロスト",
        vampire: "ヴァンパイア",
        bomber: "ボマー",
        descArcher: "矢を放つ",
        descKnight: "剣で斬る",
        descMage: "範囲魔法",
        descCleric: "回復",
        descNinja: "高速攻撃",
        descWizard: "雷撃",
        descBerserker: "回転攻撃",
        descFrost: "敵を減速",
        descVampire: "HP吸収",
        descBomber: "爆発弾",
        boss1: "魔王",
        boss2: "影の王",
        boss3: "虚空帝",
        boss4: "死の巨人",
        paused: "一時停止",
        pauseHint: "ESCで再開",
        resume: "再開",
        instructPause: "- 一時停止"
    },
    ko: {
        spriteFontSize: "8px",
        costFontSize: "8px",
        descFontSize: "8px",
        title: "스프라이트 서바이버",
        subtitle: "정령을 소환하고 무리에서 살아남아라",
        startGame: "게임 시작",
        instructMove: "- 이동",
        instructSummon: "- 스프라이트 소환",
        instructSkill: "- 스킬 사용 (보유 시)",
        instructTip: "오브를 모으고, 스프라이트를 소환하고, 살아남아라!",
        hp: "HP",
        points: "포인트",
        sprites: "스프라이트",
        skill: "스킬",
        pressSpace: "[스페이스]",
        summonSprites: "스프라이트 소환",
        wave: "웨이브",
        nextWave: "다음 웨이브",
        bossBattle: "보스전!",
        gameOver: "게임 오버",
        finalScore: "최종 점수",
        waveReached: "도달 웨이브",
        restart: "재시작",
        victory: "승리!",
        victoryMsg: "최종 보스를 처치했다!",
        playAgain: "다시 하기",
        language: "언어",
        controlsHint: "WASD/방향키 이동 | 1-0 or ZXCVBNM,./ 소환 | 스페이스 스킬 | ESC 일시정지",
        skillDash: "대시",
        skillHeal: "전체 회복",
        skillNuke: "전체 공격",
        skillMagnet: "오브 흡수",
        time: "시간",
        archer: "궁수",
        knight: "기사",
        mage: "마법사",
        cleric: "성직자",
        ninja: "닌자",
        wizard: "위자드",
        berserker: "버서커",
        frost: "프로스트",
        vampire: "뱀파이어",
        bomber: "폭격수",
        descArcher: "화살 발사",
        descKnight: "검 베기",
        descMage: "범위 마법",
        descCleric: "회복",
        descNinja: "빠른 공격",
        descWizard: "번개",
        descBerserker: "회전 공격",
        descFrost: "적 감속",
        descVampire: "HP 흡수",
        descBomber: "폭발탄",
        boss1: "마왕",
        boss2: "그림자 왕",
        boss3: "허공제",
        boss4: "죽음의 거인",
        paused: "일시정지",
        pauseHint: "ESC로 재개",
        resume: "재개",
        instructPause: "- 일시정지"
    }
};

let currentLang = 'en';

function setLanguage(lang) {
    currentLang = lang;

    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        const langMap = { 'en': 'English', 'ja': '日本語', 'ko': '한국어' };
        if (btn.textContent.includes(langMap[lang])) {
            btn.classList.add('active');
        }
    });

    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });

    initSpriteButtons();
    updateSkillDisplay();
    updateUI();
}

function t(key) {
    return translations[currentLang][key] || translations['en'][key] || key;
}
