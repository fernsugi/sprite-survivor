// Language System
const translations = {
    en: {
        spriteFontSize: "7px",
        costFontSize: "8px",
        descFontSize: "7px",
        title: "SPRITE SURVIVOR",
        subtitle: "Summon spirits, survive the horde",
        startGame: "START GAME",
        instructMove: "- Move",
        instructSummon: "- Summon sprites",
        instructSkill: "- Use skill (when available)",
        instructTip: "Collect orbs, summon sprites, survive!",
        hp: "HP",
        points: "POINTS",
        sprites: "SPRITES",
        skill: "SKILL",
        pressSpace: "[SPACE]",
        summonSprites: "SUMMON SPRITES",
        wave: "WAVE",
        nextWave: "Next wave",
        bossBattle: "BOSS BATTLE!",
        gameOver: "GAME OVER",
        finalScore: "Final Score",
        score: "SCORE",
        highScore: "HIGH SCORE",
        waveReached: "Wave Reached",
        restart: "RESTART",
        victory: "VICTORY!",
        victoryMsg: "You defeated the final boss!",
        playAgain: "PLAY AGAIN",
        language: "LANGUAGE",
        skillDash: "DASH",
        skillHeal: "FULL HEAL",
        skillNuke: "SCREEN BLAST",
        skillMagnet: "ORB MAGNET",
        skillHero: "HERO",
        heroLaser: "Laser",
        heroWarrior: "Warrior",
        heroAngel: "Angel",
        heroBouncer: "Bouncer",
        time: "Time",
        archer: "Archer",
        knight: "Knight",
        mage: "Mage",
        cleric: "Cleric",
        ninja: "Ninja",
        wizard: "Wizard",
        berserker: "Berserker",
        frost: "Frost",
        vampire: "Vampire",
        bomber: "Bomber",
        descArcher: "Shoots arrows",
        descKnight: "Sword slash",
        descMage: "AOE magic",
        descCleric: "Heals you",
        descNinja: "Fast attacks",
        descWizard: "Lightning",
        descBerserker: "Spin attack",
        descFrost: "Slows enemies",
        descVampire: "Lifesteal hits",
        descBomber: "Explosive shots",
        boss1: "Demon Lord",
        boss2: "Shadow King",
        boss3: "Void Emperor",
        boss4: "Death Titan",
        paused: "PAUSED",
        pauseHint: "Press ESC to resume",
        resume: "RESUME",
        instructPause: "- Pause",
        instructAutopilot: "- Toggle autopilot",
        cheatMode: "CHEAT MODE",
        mainMenu: "MAIN MENU",
        achievements: "ACHIEVEMENTS",
        achvFirstWin: "First Victory",
        achvFirstWinDesc: "Win the game for the first time",
        achvOnlySpriteDesc: "Win using only",
        achvAllSprites: "Full Arsenal",
        achvAllSpritesDesc: "Win with all 10 sprite types",
        achvSpeedrun: "Speedrunner",
        achvSpeedrunDesc: "Win in under 10 minutes",
        achvNoHit: "Untouchable",
        achvNoHitDesc: "Win without getting hit",
        achvFirstHero: "Hero Summoner",
        achvFirstHeroDesc: "Summon a hero for the first time",
        achvNoSprites: "Solo Run",
        achvNoSpritesDesc: "Win without summoning any sprites",
        achvUnlocked: "Achievements Unlocked"
    },
    ja: {
        spriteFontSize: "9px",
        costFontSize: "7px",
        descFontSize: "9px",
        title: "スプライトサバイバー",
        subtitle: "精霊を召喚し、群れを生き延びろ",
        startGame: "ゲームスタート",
        instructMove: "- 移動",
        instructSummon: "- スプライト召喚",
        instructSkill: "- スキル発動（所持時）",
        instructTip: "オーブを集め、スプライトを召喚し、生き残れ！",
        hp: "HP",
        points: "ポイント",
        sprites: "スプライト",
        skill: "スキル",
        pressSpace: "[スペース]",
        summonSprites: "スプライト召喚",
        wave: "ウェーブ",
        nextWave: "次のウェーブ",
        bossBattle: "ボス戦！",
        gameOver: "ゲームオーバー",
        finalScore: "最終スコア",
        score: "スコア",
        highScore: "ハイスコア",
        waveReached: "到達ウェーブ",
        restart: "リスタート",
        victory: "勝利！",
        victoryMsg: "最終ボスを倒した！",
        playAgain: "もう一度",
        language: "言語",
        skillDash: "ダッシュ",
        skillHeal: "全回復",
        skillNuke: "全画面攻撃",
        skillMagnet: "オーブ吸引",
        skillHero: "ヒーロー",
        heroLaser: "レーザー",
        heroWarrior: "戦士",
        heroAngel: "天使",
        heroBouncer: "バウンサー",
        time: "タイム",
        archer: "アーチャー",
        knight: "ナイト",
        mage: "メイジ",
        cleric: "クレリック",
        ninja: "ニンジャ",
        wizard: "ウィザード",
        berserker: "バーサーカー",
        frost: "フロスト",
        vampire: "ヴァンパイア",
        bomber: "ボマー",
        descArcher: "矢を放つ",
        descKnight: "剣で斬る",
        descMage: "範囲魔法",
        descCleric: "回復",
        descNinja: "高速攻撃",
        descWizard: "雷撃",
        descBerserker: "回転攻撃",
        descFrost: "敵を減速",
        descVampire: "HP吸収",
        descBomber: "爆発弾",
        boss1: "魔王",
        boss2: "影の王",
        boss3: "虚空帝",
        boss4: "死の巨人",
        paused: "一時停止",
        pauseHint: "ESCで再開",
        resume: "再開",
        instructPause: "- 一時停止",
        instructAutopilot: "- オート切替",
        cheatMode: "チートモード",
        mainMenu: "メインメニュー",
        achievements: "実績",
        achvFirstWin: "初勝利",
        achvFirstWinDesc: "初めてゲームをクリア",
        achvOnlySpriteDesc: "のみでクリア",
        achvAllSprites: "フルアーセナル",
        achvAllSpritesDesc: "全10種のスプライトでクリア",
        achvSpeedrun: "スピードランナー",
        achvSpeedrunDesc: "10分以内にクリア",
        achvNoHit: "無傷",
        achvNoHitDesc: "ノーダメージでクリア",
        achvFirstHero: "ヒーロー召喚者",
        achvFirstHeroDesc: "初めてヒーローを召喚",
        achvNoSprites: "ソロラン",
        achvNoSpritesDesc: "スプライトなしでクリア",
        achvUnlocked: "獲得した実績"
    },
    ko: {
        spriteFontSize: "8px",
        costFontSize: "8px",
        descFontSize: "8px",
        title: "스프라이트 서바이버",
        subtitle: "정령을 소환하고 무리에서 살아남아라",
        startGame: "게임 시작",
        instructMove: "- 이동",
        instructSummon: "- 스프라이트 소환",
        instructSkill: "- 스킬 사용 (보유 시)",
        instructTip: "오브를 모으고, 스프라이트를 소환하고, 살아남아라!",
        hp: "HP",
        points: "포인트",
        sprites: "스프라이트",
        skill: "스킬",
        pressSpace: "[스페이스]",
        summonSprites: "스프라이트 소환",
        wave: "웨이브",
        nextWave: "다음 웨이브",
        bossBattle: "보스전!",
        gameOver: "게임 오버",
        finalScore: "최종 점수",
        score: "점수",
        highScore: "최고 점수",
        waveReached: "도달 웨이브",
        restart: "재시작",
        victory: "승리!",
        victoryMsg: "최종 보스를 처치했다!",
        playAgain: "다시 하기",
        language: "언어",
        skillDash: "대시",
        skillHeal: "전체 회복",
        skillNuke: "전체 공격",
        skillMagnet: "오브 흡수",
        skillHero: "영웅",
        heroLaser: "레이저",
        heroWarrior: "전사",
        heroAngel: "천사",
        heroBouncer: "바운서",
        time: "시간",
        archer: "궁수",
        knight: "기사",
        mage: "마법사",
        cleric: "성직자",
        ninja: "닌자",
        wizard: "위자드",
        berserker: "버서커",
        frost: "프로스트",
        vampire: "뱀파이어",
        bomber: "폭격수",
        descArcher: "화살 발사",
        descKnight: "검 베기",
        descMage: "범위 마법",
        descCleric: "회복",
        descNinja: "빠른 공격",
        descWizard: "번개",
        descBerserker: "회전 공격",
        descFrost: "적 감속",
        descVampire: "HP 흡수",
        descBomber: "폭발탄",
        boss1: "마왕",
        boss2: "그림자 왕",
        boss3: "허공제",
        boss4: "죽음의 거인",
        paused: "일시정지",
        pauseHint: "ESC로 재개",
        resume: "재개",
        instructPause: "- 일시정지",
        instructAutopilot: "- 자동 전환",
        cheatMode: "치트 모드",
        mainMenu: "메인 메뉴",
        achievements: "업적",
        achvFirstWin: "첫 승리",
        achvFirstWinDesc: "처음으로 게임 클리어",
        achvOnlySpriteDesc: "만으로 클리어",
        achvAllSprites: "풀 아스날",
        achvAllSpritesDesc: "10종 스프라이트 모두 사용하여 클리어",
        achvSpeedrun: "스피드러너",
        achvSpeedrunDesc: "10분 이내 클리어",
        achvNoHit: "무적",
        achvNoHitDesc: "피해 없이 클리어",
        achvFirstHero: "영웅 소환사",
        achvFirstHeroDesc: "처음으로 영웅 소환",
        achvNoSprites: "솔로 런",
        achvNoSpritesDesc: "스프라이트 없이 클리어",
        achvUnlocked: "획득한 업적"
    },
    "zh-TW": {
        spriteFontSize: "9px",
        costFontSize: "8px",
        descFontSize: "9px",
        title: "精靈生存者",
        subtitle: "召喚精靈，在群敵中生存",
        startGame: "開始遊戲",
        instructMove: "- 移動",
        instructSummon: "- 召喚精靈",
        instructSkill: "- 使用技能（持有時）",
        instructTip: "收集寶珠，召喚精靈，活下去！",
        hp: "HP",
        points: "點數",
        sprites: "精靈",
        skill: "技能",
        pressSpace: "[空白鍵]",
        summonSprites: "召喚精靈",
        wave: "波次",
        nextWave: "下一波",
        bossBattle: "魔王戰！",
        gameOver: "遊戲結束",
        finalScore: "最終分數",
        score: "分數",
        highScore: "最高分",
        waveReached: "到達波次",
        restart: "重新開始",
        victory: "勝利！",
        victoryMsg: "你擊敗了最終魔王！",
        playAgain: "再玩一次",
        language: "語言",
        skillDash: "衝刺",
        skillHeal: "完全回復",
        skillNuke: "全螢幕攻擊",
        skillMagnet: "寶珠吸收",
        skillHero: "英雄",
        heroLaser: "雷射",
        heroWarrior: "戰士",
        heroAngel: "天使",
        heroBouncer: "彈跳者",
        time: "時間",
        archer: "弓箭手",
        knight: "騎士",
        mage: "法師",
        cleric: "牧師",
        ninja: "忍者",
        wizard: "巫師",
        berserker: "狂戰士",
        frost: "冰霜",
        vampire: "吸血鬼",
        bomber: "轟炸手",
        descArcher: "射箭",
        descKnight: "劍擊",
        descMage: "範圍魔法",
        descCleric: "治療",
        descNinja: "快速攻擊",
        descWizard: "閃電",
        descBerserker: "旋轉攻擊",
        descFrost: "減速敵人",
        descVampire: "吸血攻擊",
        descBomber: "爆炸彈",
        boss1: "魔王",
        boss2: "暗影之王",
        boss3: "虛空帝",
        boss4: "死亡巨人",
        paused: "暫停",
        pauseHint: "按ESC繼續",
        resume: "繼續",
        instructPause: "- 暫停",
        instructAutopilot: "- 自動模式",
        cheatMode: "作弊模式",
        mainMenu: "主選單",
        achievements: "成就",
        achvFirstWin: "首次勝利",
        achvFirstWinDesc: "首次通關遊戲",
        achvOnlySpriteDesc: "僅使用通關",
        achvAllSprites: "全員集合",
        achvAllSpritesDesc: "使用全部10種精靈通關",
        achvSpeedrun: "速通達人",
        achvSpeedrunDesc: "10分鐘內通關",
        achvNoHit: "無傷通關",
        achvNoHitDesc: "不受傷害通關",
        achvFirstHero: "英雄召喚師",
        achvFirstHeroDesc: "首次召喚英雄",
        achvNoSprites: "單人挑戰",
        achvNoSpritesDesc: "不召喚精靈通關",
        achvUnlocked: "獲得的成就"
    },
    "zh-CN": {
        spriteFontSize: "9px",
        costFontSize: "8px",
        descFontSize: "9px",
        title: "精灵生存者",
        subtitle: "召唤精灵，在群敌中生存",
        startGame: "开始游戏",
        instructMove: "- 移动",
        instructSummon: "- 召唤精灵",
        instructSkill: "- 使用技能（持有时）",
        instructTip: "收集宝珠，召唤精灵，活下去！",
        hp: "HP",
        points: "点数",
        sprites: "精灵",
        skill: "技能",
        pressSpace: "[空格键]",
        summonSprites: "召唤精灵",
        wave: "波次",
        nextWave: "下一波",
        bossBattle: "魔王战！",
        gameOver: "游戏结束",
        finalScore: "最终分数",
        score: "分数",
        highScore: "最高分",
        waveReached: "到达波次",
        restart: "重新开始",
        victory: "胜利！",
        victoryMsg: "你击败了最终魔王！",
        playAgain: "再玩一次",
        language: "语言",
        skillDash: "冲刺",
        skillHeal: "完全恢复",
        skillNuke: "全屏攻击",
        skillMagnet: "宝珠吸收",
        skillHero: "英雄",
        heroLaser: "激光",
        heroWarrior: "战士",
        heroAngel: "天使",
        heroBouncer: "弹跳者",
        time: "时间",
        archer: "弓箭手",
        knight: "骑士",
        mage: "法师",
        cleric: "牧师",
        ninja: "忍者",
        wizard: "巫师",
        berserker: "狂战士",
        frost: "冰霜",
        vampire: "吸血鬼",
        bomber: "轰炸手",
        descArcher: "射箭",
        descKnight: "剑击",
        descMage: "范围魔法",
        descCleric: "治疗",
        descNinja: "快速攻击",
        descWizard: "闪电",
        descBerserker: "旋转攻击",
        descFrost: "减速敌人",
        descVampire: "吸血攻击",
        descBomber: "爆炸弹",
        boss1: "魔王",
        boss2: "暗影之王",
        boss3: "虚空帝",
        boss4: "死亡巨人",
        paused: "暂停",
        pauseHint: "按ESC继续",
        resume: "继续",
        instructPause: "- 暂停",
        instructAutopilot: "- 自动模式",
        cheatMode: "作弊模式",
        mainMenu: "主菜单",
        achievements: "成就",
        achvFirstWin: "首次胜利",
        achvFirstWinDesc: "首次通关游戏",
        achvOnlySpriteDesc: "仅使用通关",
        achvAllSprites: "全员集合",
        achvAllSpritesDesc: "使用全部10种精灵通关",
        achvSpeedrun: "速通达人",
        achvSpeedrunDesc: "10分钟内通关",
        achvNoHit: "无伤通关",
        achvNoHitDesc: "不受伤害通关",
        achvFirstHero: "英雄召唤师",
        achvFirstHeroDesc: "首次召唤英雄",
        achvNoSprites: "单人挑战",
        achvNoSpritesDesc: "不召唤精灵通关",
        achvUnlocked: "获得的成就"
    },
    es: {
        spriteFontSize: "7px",
        costFontSize: "8px",
        descFontSize: "7px",
        title: "SPRITE SURVIVOR",
        subtitle: "Invoca espíritus, sobrevive a la horda",
        startGame: "INICIAR JUEGO",
        instructMove: "- Mover",
        instructSummon: "- Invocar sprites",
        instructSkill: "- Usar habilidad (cuando esté disponible)",
        instructTip: "¡Recoge orbes, invoca sprites, sobrevive!",
        hp: "HP",
        points: "PUNTOS",
        sprites: "SPRITES",
        skill: "HABILIDAD",
        pressSpace: "[ESPACIO]",
        summonSprites: "INVOCAR SPRITES",
        wave: "OLEADA",
        nextWave: "Siguiente oleada",
        bossBattle: "¡BATALLA DE JEFE!",
        gameOver: "FIN DEL JUEGO",
        finalScore: "Puntuación Final",
        score: "PUNTOS",
        highScore: "RÉCORD",
        waveReached: "Oleada Alcanzada",
        restart: "REINICIAR",
        victory: "¡VICTORIA!",
        victoryMsg: "¡Derrotaste al jefe final!",
        playAgain: "JUGAR DE NUEVO",
        language: "IDIOMA",
        skillDash: "DASH",
        skillHeal: "CURACIÓN TOTAL",
        skillNuke: "EXPLOSIÓN",
        skillMagnet: "IMÁN DE ORBES",
        skillHero: "HÉROE",
        heroLaser: "Láser",
        heroWarrior: "Guerrero",
        heroAngel: "Ángel",
        heroBouncer: "Rebotador",
        time: "Tiempo",
        archer: "Arquero",
        knight: "Caballero",
        mage: "Mago",
        cleric: "Clérigo",
        ninja: "Ninja",
        wizard: "Hechicero",
        berserker: "Berserker",
        frost: "Hielo",
        vampire: "Vampiro",
        bomber: "Bomba",
        descArcher: "Dispara flechas",
        descKnight: "Corte de espada",
        descMage: "Magia de área",
        descCleric: "Te cura",
        descNinja: "Ataques rápidos",
        descWizard: "Relámpago",
        descBerserker: "Ataque giratorio",
        descFrost: "Ralentiza enemigos",
        descVampire: "Roba vida",
        descBomber: "Disparos explosivos",
        boss1: "Señor Demonio",
        boss2: "Rey Sombra",
        boss3: "Emperador del Vacío",
        boss4: "Titán de la Muerte",
        paused: "PAUSADO",
        pauseHint: "Presiona ESC para continuar",
        resume: "CONTINUAR",
        instructPause: "- Pausar",
        instructAutopilot: "- Auto piloto",
        cheatMode: "MODO TRAMPA",
        mainMenu: "MENU PRINCIPAL",
        achievements: "LOGROS",
        achvFirstWin: "Primera Victoria",
        achvFirstWinDesc: "Gana el juego por primera vez",
        achvOnlySpriteDesc: "Gana usando solo",
        achvAllSprites: "Arsenal Completo",
        achvAllSpritesDesc: "Gana con los 10 tipos de sprites",
        achvSpeedrun: "Velocista",
        achvSpeedrunDesc: "Gana en menos de 10 minutos",
        achvNoHit: "Intocable",
        achvNoHitDesc: "Gana sin recibir daño",
        achvFirstHero: "Invocador de Héroes",
        achvFirstHeroDesc: "Invoca un héroe por primera vez",
        achvNoSprites: "Carrera en Solitario",
        achvNoSpritesDesc: "Gana sin invocar sprites",
        achvUnlocked: "Logros Desbloqueados"
    },
    pt: {
        spriteFontSize: "6px",
        costFontSize: "8px",
        descFontSize: "7px",
        title: "SPRITE SURVIVOR",
        subtitle: "Invoque espíritos, sobreviva à horda",
        startGame: "INICIAR JOGO",
        instructMove: "- Mover",
        instructSummon: "- Invocar sprites",
        instructSkill: "- Usar habilidade (quando disponível)",
        instructTip: "Colete orbes, invoque sprites, sobreviva!",
        hp: "HP",
        points: "PONTOS",
        sprites: "SPRITES",
        skill: "HABILIDADE",
        pressSpace: "[ESPAÇO]",
        summonSprites: "INVOCAR SPRITES",
        wave: "ONDA",
        nextWave: "Próxima onda",
        bossBattle: "BATALHA DE CHEFE!",
        gameOver: "FIM DE JOGO",
        finalScore: "Pontuação Final",
        score: "PONTOS",
        highScore: "RECORDE",
        waveReached: "Onda Alcançada",
        restart: "REINICIAR",
        victory: "VITÓRIA!",
        victoryMsg: "Você derrotou o chefe final!",
        playAgain: "JOGAR NOVAMENTE",
        language: "IDIOMA",
        skillDash: "DASH",
        skillHeal: "CURA TOTAL",
        skillNuke: "EXPLOSÃO",
        skillMagnet: "IMÃ DE ORBES",
        skillHero: "HERÓI",
        heroLaser: "Laser",
        heroWarrior: "Guerreiro",
        heroAngel: "Anjo",
        heroBouncer: "Saltador",
        time: "Tempo",
        archer: "Arqueiro",
        knight: "Cavaleiro",
        mage: "Mago",
        cleric: "Clérigo",
        ninja: "Ninja",
        wizard: "Feiticeiro",
        berserker: "Berserker",
        frost: "Gelo",
        vampire: "Vampiro",
        bomber: "Bomba",
        descArcher: "Atira flechas",
        descKnight: "Corte de espada",
        descMage: "Magia de área",
        descCleric: "Cura você",
        descNinja: "Ataques rápidos",
        descWizard: "Relâmpago",
        descBerserker: "Ataque giratório",
        descFrost: "Desacelera inimigos",
        descVampire: "Rouba vida",
        descBomber: "Tiros explosivos",
        boss1: "Senhor Demônio",
        boss2: "Rei Sombra",
        boss3: "Imperador do Vazio",
        boss4: "Titã da Morte",
        paused: "PAUSADO",
        pauseHint: "Pressione ESC para continuar",
        resume: "CONTINUAR",
        instructPause: "- Pausar",
        instructAutopilot: "- Auto piloto",
        cheatMode: "MODO TRAPAÇA",
        mainMenu: "MENU PRINCIPAL",
        achievements: "CONQUISTAS",
        achvFirstWin: "Primeira Vitória",
        achvFirstWinDesc: "Vença o jogo pela primeira vez",
        achvOnlySpriteDesc: "Vença usando apenas",
        achvAllSprites: "Arsenal Completo",
        achvAllSpritesDesc: "Vença com todos os 10 tipos de sprites",
        achvSpeedrun: "Velocista",
        achvSpeedrunDesc: "Vença em menos de 10 minutos",
        achvNoHit: "Intocável",
        achvNoHitDesc: "Vença sem receber dano",
        achvFirstHero: "Invocador de Heróis",
        achvFirstHeroDesc: "Invoque um herói pela primeira vez",
        achvNoSprites: "Corrida Solo",
        achvNoSpritesDesc: "Vença sem invocar sprites",
        achvUnlocked: "Conquistas Desbloqueadas"
    },
    ru: {
        spriteFontSize: "7px",
        costFontSize: "8px",
        descFontSize: "7px",
        title: "SPRITE SURVIVOR",
        subtitle: "Призывай духов, выживай в орде",
        startGame: "НАЧАТЬ ИГРУ",
        instructMove: "- Движение",
        instructSummon: "- Призыв спрайтов",
        instructSkill: "- Использовать умение (когда доступно)",
        instructTip: "Собирай сферы, призывай спрайтов, выживай!",
        hp: "HP",
        points: "ОЧКИ",
        sprites: "СПРАЙТЫ",
        skill: "УМЕНИЕ",
        pressSpace: "[ПРОБЕЛ]",
        summonSprites: "ПРИЗЫВ СПРАЙТОВ",
        wave: "ВОЛНА",
        nextWave: "Следующая волна",
        bossBattle: "БОЙ С БОССОМ!",
        gameOver: "ИГРА ОКОНЧЕНА",
        finalScore: "Финальный счёт",
        score: "СЧЁТ",
        highScore: "РЕКОРД",
        waveReached: "Достигнута волна",
        restart: "ЗАНОВО",
        victory: "ПОБЕДА!",
        victoryMsg: "Вы победили финального босса!",
        playAgain: "ИГРАТЬ СНОВА",
        language: "ЯЗЫК",
        skillDash: "РЫВОК",
        skillHeal: "ПОЛНОЕ ИСЦЕЛЕНИЕ",
        skillNuke: "ВЗРЫВ",
        skillMagnet: "МАГНИТ СФЕР",
        skillHero: "ГЕРОЙ",
        heroLaser: "Лазер",
        heroWarrior: "Воин",
        heroAngel: "Ангел",
        heroBouncer: "Прыгун",
        time: "Время",
        archer: "Лучник",
        knight: "Рыцарь",
        mage: "Маг",
        cleric: "Жрец",
        ninja: "Ниндзя",
        wizard: "Волшебник",
        berserker: "Берсерк",
        frost: "Лёд",
        vampire: "Вампир",
        bomber: "Подрывник",
        descArcher: "Стреляет стрелами",
        descKnight: "Удар мечом",
        descMage: "Магия области",
        descCleric: "Лечит вас",
        descNinja: "Быстрые атаки",
        descWizard: "Молния",
        descBerserker: "Вращающаяся атака",
        descFrost: "Замедляет врагов",
        descVampire: "Похищает жизнь",
        descBomber: "Взрывные выстрелы",
        boss1: "Повелитель Демонов",
        boss2: "Король Теней",
        boss3: "Император Пустоты",
        boss4: "Титан Смерти",
        paused: "ПАУЗА",
        pauseHint: "Нажмите ESC для продолжения",
        resume: "ПРОДОЛЖИТЬ",
        instructPause: "- Пауза",
        instructAutopilot: "- Автопилот",
        cheatMode: "ЧИТ-РЕЖИМ",
        mainMenu: "ГЛАВНОЕ МЕНЮ",
        achievements: "ДОСТИЖЕНИЯ",
        achvFirstWin: "Первая Победа",
        achvFirstWinDesc: "Выиграть игру впервые",
        achvOnlySpriteDesc: "Выиграть только с",
        achvAllSprites: "Полный Арсенал",
        achvAllSpritesDesc: "Выиграть со всеми 10 типами спрайтов",
        achvSpeedrun: "Спидраннер",
        achvSpeedrunDesc: "Выиграть менее чем за 10 минут",
        achvNoHit: "Неуязвимый",
        achvNoHitDesc: "Выиграть без получения урона",
        achvFirstHero: "Призыватель Героев",
        achvFirstHeroDesc: "Призвать героя впервые",
        achvNoSprites: "Соло Забег",
        achvNoSpritesDesc: "Выиграть без призыва спрайтов",
        achvUnlocked: "Разблокированные Достижения"
    },
    fr: {
        spriteFontSize: "7px",
        costFontSize: "8px",
        descFontSize: "7px",
        title: "SPRITE SURVIVOR",
        subtitle: "Invoque des esprits, survis à la horde",
        startGame: "JOUER",
        instructMove: "- Déplacer",
        instructSummon: "- Invoquer des sprites",
        instructSkill: "- Utiliser compétence (si disponible)",
        instructTip: "Collecte des orbes, invoque des sprites, survis !",
        hp: "PV",
        points: "POINTS",
        sprites: "SPRITES",
        skill: "COMPÉTENCE",
        pressSpace: "[ESPACE]",
        summonSprites: "INVOQUER SPRITES",
        wave: "VAGUE",
        nextWave: "Prochaine vague",
        bossBattle: "COMBAT DE BOSS !",
        gameOver: "FIN DE PARTIE",
        finalScore: "Score Final",
        score: "SCORE",
        highScore: "RECORD",
        waveReached: "Vague Atteinte",
        restart: "RECOMMENCER",
        victory: "VICTOIRE !",
        victoryMsg: "Vous avez vaincu le boss final !",
        playAgain: "REJOUER",
        language: "LANGUE",
        skillDash: "DASH",
        skillHeal: "SOIN COMPLET",
        skillNuke: "EXPLOSION",
        skillMagnet: "AIMANT À ORBES",
        skillHero: "HÉROS",
        heroLaser: "Laser",
        heroWarrior: "Guerrier",
        heroAngel: "Ange",
        heroBouncer: "Rebond",
        time: "Temps",
        archer: "Archer",
        knight: "Chevalier",
        mage: "Mage",
        cleric: "Clerc",
        ninja: "Ninja",
        wizard: "Sorcier",
        berserker: "Berserker",
        frost: "Givre",
        vampire: "Vampire",
        bomber: "Bomba",
        descArcher: "Tire des flèches",
        descKnight: "Coup d'épée",
        descMage: "Magie de zone",
        descCleric: "Vous soigne",
        descNinja: "Attaques rapides",
        descWizard: "Éclair",
        descBerserker: "Attaque tourbillon",
        descFrost: "Ralentit ennemis",
        descVampire: "Vol de vie",
        descBomber: "Tirs explosifs",
        boss1: "Seigneur Démon",
        boss2: "Roi des Ombres",
        boss3: "Empereur du Vide",
        boss4: "Titan de la Mort",
        paused: "PAUSE",
        pauseHint: "Appuyez sur ESC pour reprendre",
        resume: "REPRENDRE",
        instructPause: "- Pause",
        instructAutopilot: "- Auto pilote",
        cheatMode: "MODE TRICHE",
        mainMenu: "MENU PRINCIPAL",
        achievements: "SUCCÈS",
        achvFirstWin: "Première Victoire",
        achvFirstWinDesc: "Gagner le jeu pour la première fois",
        achvOnlySpriteDesc: "Gagner en utilisant seulement",
        achvAllSprites: "Arsenal Complet",
        achvAllSpritesDesc: "Gagner avec les 10 types de sprites",
        achvSpeedrun: "Speedrunner",
        achvSpeedrunDesc: "Gagner en moins de 10 minutes",
        achvNoHit: "Intouchable",
        achvNoHitDesc: "Gagner sans prendre de dégâts",
        achvFirstHero: "Invocateur de Héros",
        achvFirstHeroDesc: "Invoquer un héros pour la première fois",
        achvNoSprites: "Course en Solo",
        achvNoSpritesDesc: "Gagner sans invoquer de sprites",
        achvUnlocked: "Succès Débloqués"
    },
    vi: {
        spriteFontSize: "10px",
        costFontSize: "10px",
        descFontSize: "10px",
        title: "SPRITE SURVIVOR",
        subtitle: "Triệu hồi linh hồn, sống sót qua bầy quái",
        startGame: "BẮT ĐẦU",
        instructMove: "- Di chuyển",
        instructSummon: "- Triệu hồi sprite",
        instructSkill: "- Dùng kỹ năng (khi có)",
        instructTip: "Thu thập cầu, triệu hồi sprite, sinh tồn!",
        hp: "HP",
        points: "ĐIỂM",
        sprites: "SPRITE",
        skill: "KỸ NĂNG",
        pressSpace: "[SPACE]",
        summonSprites: "TRIỆU HỒI SPRITE",
        wave: "ĐỢT",
        nextWave: "Đợt tiếp theo",
        bossBattle: "ĐÁNH BOSS!",
        gameOver: "KẾT THÚC",
        finalScore: "Điểm cuối",
        score: "ĐIỂM",
        highScore: "KỶ LỤC",
        waveReached: "Đợt đạt được",
        restart: "CHƠI LẠI",
        victory: "CHIẾN THẮNG!",
        victoryMsg: "Bạn đã đánh bại boss cuối!",
        playAgain: "CHƠI LẠI",
        language: "T.Noi",
        skillDash: "LƯỚT",
        skillHeal: "HỒI ĐẦY",
        skillNuke: "NỔ MÀN HÌNH",
        skillMagnet: "HÚT CẦU",
        skillHero: "ANH HÙNG",
        heroLaser: "Laser",
        heroWarrior: "Chiến Binh",
        heroAngel: "Thiên Thần",
        heroBouncer: "Nảy",
        time: "Thời gian",
        archer: "Cung thủ",
        knight: "Hiệp sĩ",
        mage: "Pháp sư",
        cleric: "Thầy tu",
        ninja: "Ninja",
        wizard: "Phù thủy",
        berserker: "Cuồng chiến",
        frost: "Băng giá",
        vampire: "Ma cà rồng",
        bomber: "Ném bom",
        descArcher: "Bắn tên",
        descKnight: "Chém kiếm",
        descMage: "Phép vùng",
        descCleric: "Hồi máu",
        descNinja: "Đánh nhanh",
        descWizard: "Sét đánh",
        descBerserker: "Xoay tấn công",
        descFrost: "Làm chậm địch",
        descVampire: "Hút máu",
        descBomber: "Đạn nổ",
        boss1: "Chúa Quỷ",
        boss2: "Vua Bóng Tối",
        boss3: "Hoàng Đế Hư Vô",
        boss4: "Thần Chết",
        paused: "TẠM DỪNG",
        pauseHint: "Nhấn ESC để tiếp tục",
        resume: "TIẾP TỤC",
        instructPause: "- Tạm dừng",
        instructAutopilot: "- Tự động",
        cheatMode: "CHẾ ĐỘ ĂN GIAN",
        mainMenu: "MENU CHÍNH",
        achievements: "THÀNH TÍCH",
        achvFirstWin: "Chiến Thắng Đầu",
        achvFirstWinDesc: "Thắng game lần đầu",
        achvOnlySpriteDesc: "Thắng chỉ dùng",
        achvAllSprites: "Đủ Bộ Sưu Tập",
        achvAllSpritesDesc: "Thắng với đủ 10 loại sprite",
        achvSpeedrun: "Tốc Độ",
        achvSpeedrunDesc: "Thắng dưới 10 phút",
        achvNoHit: "Bất Bại",
        achvNoHitDesc: "Thắng không bị trúng đòn",
        achvFirstHero: "Triệu Hồi Anh Hùng",
        achvFirstHeroDesc: "Triệu hồi anh hùng lần đầu",
        achvNoSprites: "Chạy Đơn",
        achvNoSpritesDesc: "Thắng không triệu hồi sprite",
        achvUnlocked: "Thành Tích Đạt Được"
    }
};

// SEO metadata for each language (DRY: centralized SEO data)
const seoData = {
    en: {
        title: "Sprite Survivor - Free Browser Survival Game | Play Online",
        description: "Play Sprite Survivor free in your browser! Summon powerful sprites, defeat epic bosses, and survive endless waves. No download required."
    },
    ja: {
        title: "スプライトサバイバー - 無料ブラウザゲーム | オンラインでプレイ",
        description: "スプライトサバイバーを無料でプレイ！強力なスプライトを召喚し、ボスを倒し、無限のウェーブを生き延びよう。ダウンロード不要。"
    },
    ko: {
        title: "스프라이트 서바이버 - 무료 브라우저 생존 게임 | 온라인 플레이",
        description: "스프라이트 서바이버를 무료로 플레이하세요! 강력한 스프라이트를 소환하고, 보스를 물리치고, 끝없는 웨이브에서 살아남으세요."
    },
    "zh-TW": {
        title: "精靈生存者 - 免費瀏覽器生存遊戲 | 線上遊玩",
        description: "免費遊玩精靈生存者！召喚強大的精靈，擊敗史詩級Boss，在無盡的波次中生存。無需下載。"
    },
    "zh-CN": {
        title: "精灵生存者 - 免费浏览器生存游戏 | 在线游玩",
        description: "免费游玩精灵生存者！召唤强大的精灵，击败史诗级Boss，在无尽的波次中生存。无需下载。"
    },
    es: {
        title: "Sprite Survivor - Juego de Supervivencia Gratis | Jugar Online",
        description: "¡Juega Sprite Survivor gratis en tu navegador! Invoca sprites poderosos, derrota jefes épicos y sobrevive oleadas infinitas."
    },
    pt: {
        title: "Sprite Survivor - Jogo de Sobrevivência Grátis | Jogar Online",
        description: "Jogue Sprite Survivor grátis no seu navegador! Invoque sprites poderosos, derrote chefes épicos e sobreviva a ondas infinitas."
    },
    ru: {
        title: "Sprite Survivor - Бесплатная Браузерная Игра | Играть Онлайн",
        description: "Играйте в Sprite Survivor бесплатно! Призывайте мощных спрайтов, побеждайте эпических боссов и выживайте в бесконечных волнах."
    },
    fr: {
        title: "Sprite Survivor - Jeu de Survie Gratuit | Jouer en Ligne",
        description: "Jouez à Sprite Survivor gratuitement! Invoquez des sprites puissants, battez des boss épiques et survivez aux vagues infinies."
    },
    vi: {
        title: "Sprite Survivor - Game Sinh Tồn Miễn Phí | Chơi Online",
        description: "Chơi Sprite Survivor miễn phí! Triệu hồi sprite mạnh mẽ, đánh bại boss và sinh tồn qua các đợt quái vô tận."
    }
};

// Language button labels (DRY: single source of truth)
const langLabels = {
    'en': 'English', 'ja': '日本語', 'ko': '한국어', 'zh-TW': '繁體中文',
    'zh-CN': '简体中文', 'es': 'Español', 'pt': 'Portug.', 'ru': 'Русский',
    'fr': 'Français', 'vi': 'T.Viet'
};

let currentLang = 'en';

// Update meta tags for SEO
function updateSEO(lang) {
    const seo = seoData[lang] || seoData.en;

    // Update title
    document.title = seo.title;

    // Update meta tags (DRY: helper function)
    const updateMeta = (selector, attr, value) => {
        const el = document.querySelector(selector);
        if (el) el.setAttribute(attr, value);
    };

    // Primary meta
    updateMeta('meta[name="title"]', 'content', seo.title);
    updateMeta('meta[name="description"]', 'content', seo.description);

    // Open Graph
    updateMeta('meta[property="og:title"]', 'content', seo.title);
    updateMeta('meta[property="og:description"]', 'content', seo.description);
    updateMeta('meta[property="og:url"]', 'content', getLanguageURL(lang));

    // Twitter
    updateMeta('meta[name="twitter:title"]', 'content', seo.title);
    updateMeta('meta[name="twitter:description"]', 'content', seo.description);
    updateMeta('meta[name="twitter:url"]', 'content', getLanguageURL(lang));

    // Canonical
    const canonical = document.querySelector('link[rel="canonical"]');
    if (canonical) canonical.setAttribute('href', getLanguageURL(lang));
}

// Get URL for a specific language
function getLanguageURL(lang) {
    const base = 'https://spritesurvivor.com/';
    return lang === 'en' ? base : `${base}?lang=${lang}`;
}

// Update browser URL without reload
function updateURL(lang) {
    const pathname = window.location.pathname;
    const url = lang === 'en' ? pathname : `${pathname}?lang=${lang}`;
    history.replaceState({ lang }, '', url);
}

// Get language from URL parameter
function getURLLanguage() {
    const params = new URLSearchParams(window.location.search);
    const lang = params.get('lang');
    return (lang && translations[lang]) ? lang : null;
}

function setLanguage(lang, updateHistory = true) {
    if (!translations[lang]) lang = 'en';
    currentLang = lang;
    localStorage.setItem('spriteSurvivorLang', lang);

    // Vietnamese needs a different font due to diacritics
    document.body.classList.toggle('lang-vi', lang === 'vi');

    // Update language button active state
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent.includes(langLabels[lang])) {
            btn.classList.add('active');
        }
    });

    // Update all translatable elements
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });

    // Update SEO and URL
    updateSEO(lang);
    if (updateHistory) updateURL(lang);

    // Reinitialize UI components
    if (typeof initSpriteButtons === 'function') initSpriteButtons();
    if (typeof updateSkillDisplay === 'function') updateSkillDisplay();
    if (typeof updateUI === 'function') updateUI();
    // Refresh achievements list content (always regenerate when language changes)
    if (typeof refreshAchievementsList === 'function') {
        refreshAchievementsList();
    }
}

function t(key) {
    return translations[currentLang][key] || translations['en'][key] || key;
}

// Initialize language on startup (priority: URL > localStorage > default)
(function initLanguage() {
    const urlLang = getURLLanguage();
    const savedLang = localStorage.getItem('spriteSurvivorLang');
    const lang = urlLang || (savedLang && translations[savedLang] ? savedLang : 'en');

    currentLang = lang;

    const applyLanguage = () => {
        setLanguage(lang, !urlLang); // Don't update URL if already from URL
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', applyLanguage);
    } else {
        applyLanguage();
    }
})();
